/**
	Build the map **/
function Map() {
    this.spriteSheet = new Bitmap('./img/sprites.png');
    this.blocks = [
        //topX, topY, width, height, x, y
        /* Left Wall */
		[0, 0, 25, 25, 30, 60],
		[0, 0, 25, 25, 30, 70],
		[0, 0, 25, 25, 30, 80],
		[0, 0, 25, 25, 30, 90],
		[0, 0, 25, 25, 30, 100],
		[0, 0, 25, 25, 30, 110],
		[0, 0, 25, 25, 30, 120],
		[0, 0, 25, 25, 30, 130],
		[0, 0, 25, 25, 30, 140],
		[0, 0, 25, 25, 30, 150],
		[0, 0, 25, 25, 30, 160],
		[0, 0, 25, 25, 30, 170],
		[0, 0, 25, 25, 30, 180],
		[0, 0, 25, 25, 30, 190],
		[0, 0, 25, 25, 30, 200],
		[0, 0, 25, 25, 30, 210],
		[0, 0, 25, 25, 30, 220],
		[0, 0, 25, 25, 30, 230],
		[0, 0, 25, 25, 30, 240],
		[0, 0, 25, 25, 30, 250],
		[0, 0, 25, 25, 30, 260],
		[0, 0, 25, 25, 30, 270],
		[0, 0, 25, 25, 30, 280],
		[0, 0, 25, 25, 30, 290],
		[0, 0, 25, 25, 30, 300],
		[0, 0, 25, 25, 30, 310],
		[0, 0, 25, 25, 30, 320],
		[0, 0, 25, 25, 30, 330],
		[0, 0, 25, 25, 30, 340],
		[0, 0, 25, 25, 30, 350],
		[0, 0, 25, 25, 30, 360],
		[0, 0, 25, 25, 30, 370],
		[0, 0, 25, 25, 30, 380],
		[0, 0, 25, 25, 30, 390],
		
		/* Bottom wall */
		[0, 0, 25, 25, 40, 395],
		[0, 0, 25, 25, 50, 395],
		[0, 0, 25, 25, 60, 395],
		[0, 0, 25, 25, 70, 395],
		[0, 0, 25, 25, 80, 395],
		[0, 0, 25, 25, 90, 395],
		[0, 0, 25, 25, 100, 395],
		[0, 0, 25, 25, 110, 395],
		[0, 0, 25, 25, 120, 395],

		[0, 0, 25, 25, 120, 405],
		[0, 0, 25, 25, 120, 415],
		[0, 0, 25, 25, 130, 415],
		[0, 0, 25, 25, 140, 415],
		[0, 0, 25, 25, 150, 415],

		[0, 0, 25, 25, 150, 425],
		[0, 0, 25, 25, 160, 435],

		[0, 0, 25, 25, 170, 445],
		[0, 0, 25, 25, 180, 445],
		[0, 0, 25, 25, 190, 445],
		[0, 0, 25, 25, 200, 445],
		[0, 0, 25, 25, 210, 445],
		[0, 0, 25, 25, 220, 445],
		
		[0, 0, 25, 25, 230, 445],
		[0, 0, 25, 25, 230, 435],
		[0, 0, 25, 25, 230, 425],
		[0, 0, 25, 25, 240, 425],
		[0, 0, 25, 25, 250, 425],
		[0, 0, 25, 25, 260, 425],
		[0, 0, 25, 25, 270, 425],

		[0, 0, 25, 25, 270, 415],
		[0, 0, 25, 25, 280, 415],
		[0, 0, 25, 25, 290, 415],		
		[0, 0, 25, 25, 300, 415],
		[0, 0, 25, 25, 310, 415],
		
		[0, 0, 25, 25, 315, 405],
		[0, 0, 25, 25, 315, 395],
		[0, 0, 25, 25, 325, 395],
		[0, 0, 25, 25, 335, 395],
		[0, 0, 25, 25, 345, 395],
		
		/* Right Wall */
		[0, 0, 25, 25, 355, 385],
		[0, 0, 25, 25, 355, 375],
		[0, 0, 25, 25, 355, 365],
		[0, 0, 25, 25, 355, 355],
		[0, 0, 25, 25, 355, 345],
		[0, 0, 25, 25, 355, 335],
		[0, 0, 25, 25, 355, 325],
		[0, 0, 25, 25, 355, 315],
		[0, 0, 25, 25, 355, 305],
		[0, 0, 25, 25, 355, 295],
		[0, 0, 25, 25, 355, 285],
		[0, 0, 25, 25, 355, 275],
		[0, 0, 25, 25, 355, 265],
		[0, 0, 25, 25, 355, 255],
		[0, 0, 25, 25, 355, 245],
		[0, 0, 25, 25, 355, 235],
		[0, 0, 25, 25, 355, 225],
		[0, 0, 25, 25, 355, 215],
		[0, 0, 25, 25, 355, 205],
		[0, 0, 25, 25, 355, 195],
		[0, 0, 25, 25, 355, 185],
		[0, 0, 25, 25, 355, 175],
		[0, 0, 25, 25, 355, 165],
		[0, 0, 25, 25, 355, 155],
		[0, 0, 25, 25, 355, 145],
		[0, 0, 25, 25, 355, 135],
		[0, 0, 25, 25, 355, 125],
		[0, 0, 25, 25, 355, 115],
		[0, 0, 25, 25, 355, 105],
		[0, 0, 25, 25, 355, 95],
		[0, 0, 25, 25, 355, 85],
		[0, 0, 25, 25, 355, 75],
		[0, 0, 25, 25, 355, 65],
		[0, 0, 25, 25, 355, 55],
		
        /* Top Wall */
		[0, 0, 25, 25, 355, 50],
		[0, 0, 25, 25, 345, 50],
		[0, 0, 25, 25, 335, 50],
		[0, 0, 25, 25, 325, 50],
		[0, 0, 25, 25, 315, 50],
		[0, 0, 25, 25, 305, 50],
		[0, 0, 25, 25, 295, 50],
		[0, 0, 25, 25, 285, 50],
		[0, 0, 25, 25, 275, 50],
		
		/* Stone thingy */
		[0, 0, 25, 25, 265, 58],
		[0, 0, 25, 25, 265, 68],
		[0, 0, 25, 25, 265, 78],
		[0, 0, 25, 25, 265, 88],
		
		[0, 0, 25, 25, 255, 88],
		[0, 0, 25, 25, 245, 88],
		[0, 0, 25, 25, 235, 88],
		
		[0, 0, 25, 25, 235, 78],
		
		[0, 0, 25, 25, 120, 88],
		[0, 0, 25, 25, 120, 78],
		[0, 0, 25, 25, 120, 68],
		[0, 0, 25, 25, 120, 58],
		
		[0, 0, 25, 25, 130, 88],
		[0, 0, 25, 25, 140, 88],
		[0, 0, 25, 25, 150, 88],
		
		[0, 0, 25, 25, 150, 78],
		
		[0, 0, 25, 25, 140, 68],
		[0, 0, 25, 25, 140, 58],
		[0, 0, 25, 25, 140, 48],
		[0, 0, 25, 25, 140, 38],
		[0, 0, 25, 25, 140, 28],
		[0, 0, 25, 25, 140, 18],
		[0, 0, 25, 25, 140, 8],
		
		[0, 0, 25, 25, 150, 0],
		[0, 0, 25, 25, 160, 0],
		[0, 0, 25, 25, 170, 0],
		[0, 0, 25, 25, 180, 0],
		[0, 0, 25, 25, 190, 0],
		[0, 0, 25, 25, 200, 0],
		[0, 0, 25, 25, 210, 0],
		[0, 0, 25, 25, 220, 0],
		[0, 0, 25, 25, 230, 0],
		[0, 0, 25, 25, 240, 0],
		
		[0, 0, 25, 25, 244, 68],
		[0, 0, 25, 25, 244, 58],
		[0, 0, 25, 25, 244, 48],
		[0, 0, 25, 25, 244, 38],
		[0, 0, 25, 25, 244, 28],
		[0, 0, 25, 25, 244, 18],
		[0, 0, 25, 25, 244, 8],
        
        /* Top Wall */
		[0, 0, 25, 25, 40, 50],
		[0, 0, 25, 25, 50, 50],
		[0, 0, 25, 25, 60, 50],
		[0, 0, 25, 25, 70, 50],
		[0, 0, 25, 25, 80, 50],
		[0, 0, 25, 25, 90, 50],
		[0, 0, 25, 25, 100, 50],
		[0, 0, 25, 25, 110, 50],
		
		[33, 33, 26, 25, 200, 400]
    ]
};

/**
	Update the map, detect collision **/
Map.prototype.update = function(player) {
	/**
		For Debugging **/
	document.getElementById("player_x").innerHTML = player.x;
	document.getElementById("player_y").innerHTML = player.y;
	

	for (var i = 0; i < this.blocks.length; ++i) {
		if( (this.blocks[i][0] == 0) && (this.blocks[i][1] == 0) ) {
    /*	Left */
   		 	if( ((player.x < (this.blocks[i][4] - 11)) && (player.x > (this.blocks[i][4] - 25))) &&  /* if ( < 89 && > 82) */ 
    		((player.y < (this.blocks[i][5] - 11)) && (player.y > (this.blocks[i][5] - 25))) ) {
    			player.x = player.x - 10;
    /*	Right Side */
    		} else if( (player.x == this.blocks[i][4]) && 
    		((player.y < (this.blocks[i][5] - 11)) && (player.y > (this.blocks[i][5] - 25))) ) {
    			player.x = player.x + 10;
    /*	Bottom Side */
    		} else if( (player.x < this.blocks[i][4]) && (player.x > (this.blocks[i][4] - 16)) &&  
    		(player.y < (this.blocks[i][5] + 10)) && (player.y > this.blocks[i][5]) ) {
    			player.y = player.y + 10;
    /*	Top Side */
    		} else if( ((player.x < this.blocks[i][4]) && (player.x > (this.blocks[i][4] - 16))) &&  /* this is fucky */ 
    		(player.y > (this.blocks[i][5] - 30)) && (player.y < this.blocks[i][5])) {
    			player.y = player.y - 10;
    		}
   	 	} else if( (this.blocks[i][0] == 33) && (this.blocks[i][1] == 33) ) {
   	 	/* an NPC, for Lulz
   	 	*/
   	 		if(this.blocks[i][5] > 100) {
   	 			this.blocks[i][5] = this.blocks[i][5] - 10;
   	 		} else if(this.blocks[i][5] == 100 && this.blocks[i][4] > 100 ) {
   	 			this.blocks[i][4] = this.blocks[i][4] - 15;
   	 		} 

			document.getElementById("dog_x").innerHTML = this.blocks[i][4];
			document.getElementById("dog_y").innerHTML = this.blocks[i][5];
   	 	}
   	};
};
